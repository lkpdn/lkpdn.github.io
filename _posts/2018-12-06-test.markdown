---
layout: single
title: _\"Lockdep, step back to see it wholly.\"_
date: 2018-12-05 21:40:08 +0900
categories: linux
---
You would often been confronted with various kinds of lockdep notations, or even have to choose an appropriate one to use, when you would have to dive into linux kernel for some reason. This post presents its overview, which I think is rarely illustrated as a whole. The first pic is its usage pattern. You can click it to zoom in:

[![lockdep use](https://raw.githubusercontent.com/lkpdn/images/master/imgs/0002-lockdep-use-overview.png){:class="img-responsive"}](https://raw.githubusercontent.com/lkpdn/images/master/imgs/0002-lockdep-use-overview.png)

and the next one depicts the almost all relating data structure:

[![lockdep use](https://raw.githubusercontent.com/lkpdn/images/master/imgs/0003-lockdep-data-structure.png){:class="img-responsive"}](https://raw.githubusercontent.com/lkpdn/images/master/imgs/0003-lockdep-data-structure.png)

Now that you've grasped the whole picture of lockdep, I would like to show you what I think is one of the most interesting reality of how it's been used, i.e., reality sucks. The scene is where the lockdep has to be fooled by aio.

[![lockdep use](https://raw.githubusercontent.com/lkpdn/images/master/imgs/0006-lockdep-fooled-by-aio.png){:class="img-responsive"}](https://raw.githubusercontent.com/lkpdn/images/master/imgs/0006-lockdep-fooled-by-aio.png)

I tried to tackle this and remove the hack but I couldn't offer any good solution.

I hope this post helps someone.
